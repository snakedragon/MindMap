{"diagram":{"image":{"height":200,"pngdata":"iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsUlEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8GXHmAAFMgHIEAAAAAElFTkSuQmCC","width":200,"y":0,"x":0},"elements":{"id":"root","leftChildren":[{"tags":[{"text":"现状","color":"#276F86","background":"#d6f0f8"}],"id":"68400cb94a00","title":"线上日志分析","children":[{"id":"6431fe03101f","title":"目标","style":{"font-size":17,"font-weight":"bold"},"parent":"68400cb94a00","children":[{"id":"38f031bdaa71","title":"收集，归并线上错误日志，提供日志分析的数据源","parent":"6431fe03101f","children":[],"icons":[{"index":"0","text":"&#xe67a","name":"priority"}]},{"id":"c851e1587339","title":"联合分析日志，确定原因，解决方法，归入线上问题知识库","parent":"6431fe03101f","children":[],"icons":[{"index":"1","text":"&#xe625","name":"priority"}]}],"icons":[{"index":"46","text":"&#xe693","color":"rgb(191, 30, 27)","name":""},{"index":"29","text":"&#xe67e","color":"rgb(255, 159, 26)","name":"flag"},{"index":"0","text":"&#xe67a","name":"priority"}]},{"id":"f27b1c655168","title":"方案","style":{"font-size":16,"font-weight":"bold"},"children":[{"id":"76af8ae50f84","title":"确定线上日志收集约定","parent":"f27b1c655168","children":[{"id":"14a386f0a25f","title":"线上日志收集范围","parent":"76af8ae50f84","children":[{"id":"5d1049f93a51","title":"应用日志","parent":"14a386f0a25f","children":[]},{"id":"5e55ed1d2bf0","title":"Nginx日志","parent":"14a386f0a25f","children":[]},{"id":"1485763799a5","title":"GC日志","parent":"14a386f0a25f","children":[]},{"id":"727e0c5a732f","title":"JMX","parent":"14a386f0a25f","children":[]},{"id":"2e410b19b02b","title":"中间件日志","parent":"14a386f0a25f","children":[{"id":"62336fd0a0b3","title":"Redis","parent":"2e410b19b02b","children":[]},{"id":"51b5bd326b8d","title":"Kafka","parent":"2e410b19b02b","children":[]},{"id":"7702523a37f7","title":"Zookeeper","parent":"2e410b19b02b","children":[]},{"id":"4cadb3789763","title":"RocketMq","parent":"2e410b19b02b","children":[]}]}]},{"id":"70c1c8625afe","title":"日志模块统一配置","parent":"76af8ae50f84","children":[]}],"icons":[{"index":"0","text":"&#xe67a","name":"priority"}]},{"id":"4ab534cc02dc","title":"收集","children":[{"id":"f43db7cf376c","title":"flume/ELK/Kafka/Logstash","parent":"4ab534cc02dc","children":[]}],"parent":"f27b1c655168","icons":[{"index":"1","text":"&#xe625","name":"priority"}]},{"id":"dfc86495eda6","title":"保存","children":[{"id":"4d879d2b1290","title":"Solr/ElasticSearch/Hbase/Hive/tar.gz","parent":"dfc86495eda6","children":[]}],"parent":"f27b1c655168","icons":[{"index":"2","text":"&#xe62a","name":"priority"}]},{"id":"b963fd21d343","title":"分析","parent":"f27b1c655168","children":[{"id":"f0556d9445f3","title":"HiveSQL/MySql/Hadoop/MR","parent":"b963fd21d343","children":[]}],"icons":[{"index":"3","text":"&#xe635","name":"priority"}]},{"id":"4f8672fce60d","title":"应用","parent":"f27b1c655168","children":[{"id":"bf0575e3a095","title":"DailyJob","parent":"4f8672fce60d","children":[{"id":"3691b79ec534","title":"错误日志联合分析日志准备（自动把相关日志合并）","parent":"bf0575e3a095","children":[]},{"id":"22c1609484af","title":"线上错误的分配，分析，解决，归库","parent":"bf0575e3a095","children":[]},{"id":"14db4fe776a9","title":"线上错误日报","parent":"bf0575e3a095","children":[]}]}],"icons":[{"index":"4","text":"&#xe626","name":"priority"}]},{"id":"dff83d61be34","title":"展示","parent":"f27b1c655168","children":[{"id":"4fe6508edb9d","title":"Kibana","parent":"dff83d61be34","children":[]},{"id":"c85161762d58","title":"数据可视化的UI","parent":"dff83d61be34","children":[]}],"icons":[{"index":"5","text":"&#xe62b","name":"priority"}]}],"parent":"68400cb94a00","icons":[{"index":"38","text":"&#xe693","color":"rgb(113, 203, 45)","name":""},{"index":"29","text":"&#xe67e","color":"rgb(255, 159, 26)","name":"flag"},{"index":"1","text":"&#xe625","name":"priority"}]},{"id":"43605afe6f3c","title":"实施步骤","style":{"font-size":17,"font-weight":"bold"},"children":[{"id":"4460202281c7","title":"讨论确定&nbsp;日志配置规范","children":[{"id":"7a151cb0842a","title":"线上日志规范的部署实施","parent":"4460202281c7","children":[],"icons":[{"index":"2","text":"&#xe62a","name":"priority"}]}],"parent":"43605afe6f3c","icons":[{"text":"&#xe67a","index":"0","name":"priority"}]},{"id":"6d8b6ad5ba5b","title":"讨论确定并实施&nbsp;日志收集范围","children":[],"parent":"43605afe6f3c","icons":[{"text":"&#xe625","index":"1","name":"priority"}]},{"id":"477eee2052ba","title":"新老日志的收集模块搭建","children":[{"id":"9d5c8c7b50e9","title":"建立各个服务器的Flume/Logstash&nbsp;LogSource/Kafka,Rcoektmq&nbsp;producer","children":[],"parent":"477eee2052ba"},{"id":"fa4e8909db08","title":"定期将各个系统的日志文件上传归库，分目录管理，方便以后归并联合分析","children":[],"parent":"477eee2052ba"}],"parent":"43605afe6f3c","icons":[{"text":"&#xe635","index":"3","name":"priority"}]},{"id":"e7b4522a1ec5","title":"搭建日志收集中间件","children":[{"id":"f76f2c6030df","title":"Flume","children":[],"parent":"e7b4522a1ec5"},{"id":"64a688aab9e8","title":"LogStash","children":[],"parent":"e7b4522a1ec5"},{"id":"a89da71bd087","title":"Rocketmq","children":[],"parent":"e7b4522a1ec5"},{"id":"5fc8373c202d","title":"Kafka","children":[],"parent":"e7b4522a1ec5"}],"parent":"43605afe6f3c","icons":[{"text":"&#xe626","index":"4","name":"priority"}]},{"id":"07fca92471b5","title":"搭建日志持久化库","children":[{"id":"30d38b9d8933","title":"ElasticSearch&nbsp;DB （日志索引化保存，ELK架构）","children":[],"parent":"07fca92471b5"},{"id":"7500699e8192","title":"LogServer/MongoDB&nbsp; （Raw日志保存，便于归并联合分析）","children":[],"parent":"07fca92471b5"},{"id":"7d748abe7df5","title":"Hbase/Mysql&nbsp; (结构化查询，方便做统计分析)","children":[],"parent":"07fca92471b5"}],"parent":"43605afe6f3c","icons":[{"text":"&#xe62b","index":"5","name":"priority"}]},{"id":"1bad830aebb9","title":"搭建通知服务","parent":"43605afe6f3c","children":[{"id":"301844b574b1","title":"邮件服务","parent":"1bad830aebb9","children":[]},{"id":"9925a6a9bbc1","title":"微信","parent":"1bad830aebb9","children":[]},{"id":"183e6b6a3d07","title":"短信","parent":"1bad830aebb9","children":[]},{"id":"088008a2bdef","title":"自动语音呼叫播报","parent":"1bad830aebb9","children":[]}],"icons":[{"index":"6","name":"priority"}]},{"id":"5db29e2cb544","title":"日志分析任务","children":[{"id":"42daa43d1b77","title":"生成每天线上错误日志集合，并通过通知服务人","parent":"5db29e2cb544","children":[]},{"id":"8905566b8f8d","title":"生成月度统计报表","parent":"5db29e2cb544","children":[]},{"id":"dce74cff1ac1","title":"跟踪线上错误分析结果，将分析过程wiki，并标记入库，方便以后做数据分析","parent":"5db29e2cb544","children":[]}],"parent":"43605afe6f3c","icons":[{"index":"7","name":"priority"}]}],"parent":"68400cb94a00","icons":[{"text":"&#xe67e","index":"29","color":"rgb(255, 159, 26)","name":"flag"},{"text":"&#xe62a","index":"2","name":"priority"}]}],"parent":"root","icons":[{"index":"45","text":"&#xe693","color":"rgb(255, 159, 26)","name":""},{"index":"63","text":"&#xe693","color":"rgb(99, 171, 247)","name":""}],"note":"1.  线上日志进入kibana得范围\n2.  微信上已有错误日志通道\n3.  大部分工作已有完成\n4.  大部分功能ELK能做\n5.  是否可以把精力更多得放在用好ELK上"}],"structure":"mind_free","title":"调用链路与日志分析系统","root":true,"theme":"black","children":[{"id":"8b9e7a1801fa","title":"PinPoint链路分析","parent":"root","children":[{"id":"48c42b05fc20","title":"目标","parent":"8b9e7a1801fa","children":[{"id":"030bb54539f5","title":"统计分析热点，超时，错误请求","parent":"48c42b05fc20","children":[]},{"id":"25c4a9d01b83","title":"分析系统瓶颈","parent":"48c42b05fc20","children":[]},{"id":"deb0f353fe1d","title":"优化系统架构和调用请求","children":[],"parent":"48c42b05fc20"}],"icons":[{"text":"&#xe67a","index":"0","name":"priority"},{"text":"&#xe67e","index":"31","color":"rgb(80, 194, 139)","name":"flag"}]},{"id":"312138a0b5ab","title":"方案","parent":"8b9e7a1801fa","children":[{"id":"22153c57bbff","title":"实时数据同步","children":[{"id":"cf83acbd487a","title":"Hbase&nbsp;Client + Kafka","children":[],"parent":"22153c57bbff"},{"id":"463a74635b34","title":"Sqoop/DataBus/DataX","children":[],"parent":"22153c57bbff"},{"id":"f487c1d93579","title":"HDFS&nbsp;Sync","children":[],"parent":"22153c57bbff"},{"id":"e286ce0e86f4","title":"Kettle","parent":"22153c57bbff","children":[]}],"parent":"312138a0b5ab"},{"tags":[{"text":"目的","color":"#276F86","background":"#d6f0f8"}],"id":"a37da54e6454","title":"消息中间件集群","parent":"312138a0b5ab","children":[{"id":"b147dd6db58c","title":"RocketMQ","parent":"a37da54e6454","children":[]},{"id":"597034b8d041","title":"Kafka","parent":"a37da54e6454","children":[]}],"note":"1. 保证消息不会丢失\n2. 方便实现增量同步\n3.  Proucer和Consumer不会相互影响\n"},{"id":"2a8d13d804ea","title":"&nbsp; &nbsp; 数据持久化&nbsp; &nbsp; Hbase集群","parent":"312138a0b5ab","children":[]},{"id":"d0ba73974a81","title":"在HBASE上建结构化查询系统（可选）","parent":"312138a0b5ab","children":[{"id":"dece08377872","title":"HIVE","children":[],"parent":"d0ba73974a81"},{"id":"982b69916c0c","title":"Mysql","children":[],"parent":"d0ba73974a81"}]},{"id":"3d5a4eaf1d71","title":"分析pinpoint调用链路数据","children":[{"id":"557e7158b8d9","title":"报表","children":[{"id":"d1489b3af5ea","title":"热点超时请求数据集","parent":"557e7158b8d9","children":[]}],"parent":"3d5a4eaf1d71"},{"id":"e63fb40c93f5","title":"更多维度分析","parent":"3d5a4eaf1d71","children":[]}],"parent":"312138a0b5ab"},{"id":"0964da970f9c","title":"统计排行榜","parent":"312138a0b5ab","children":[]}],"icons":[{"text":"&#xe625","index":"1","name":"priority"},{"text":"&#xe67e","index":"31","color":"rgb(80, 194, 139)","name":"flag"}]},{"id":"31d19dde3e25","title":"实施步骤","parent":"8b9e7a1801fa","children":[{"id":"80e388d36b24","title":"编写Hbase&nbsp;Client定时同步数据客户端，producer&nbsp;","children":[],"parent":"31d19dde3e25"},{"id":"9ef70a1169d1","title":"搭建或配置消息中间件&nbsp;broker、topic","children":[],"parent":"31d19dde3e25"},{"id":"7eb5c22e9145","title":"Hbase&nbsp;Client&nbsp;定时从消息中间件拉取数据，增量保存到Hbase","children":[],"parent":"31d19dde3e25"},{"id":"1583f29fd990","title":"搭建Hbase，Hive，利用HSQL来做结构化查询（可选）","children":[],"parent":"31d19dde3e25"},{"id":"cb84bce0ab6c","title":"Pinpint调用链路数据分析","children":[{"id":"1c4387203ec9","title":"python实现","children":[],"parent":"cb84bce0ab6c"},{"id":"13fcf43e68d4","title":"java实现","children":[],"parent":"cb84bce0ab6c"}],"parent":"31d19dde3e25"}],"icons":[{"text":"&#xe62a","index":"2","name":"priority"},{"text":"&#xe67e","index":"31","color":"rgb(80, 194, 139)","name":"flag"}]}]}]}},"meta":{"id":"5adea019e4b0518eaccd4d3c","member":"5ade96c6e4b0518eaccd0a8c","exportTime":"2018-05-21 12:58:45","diagramInfo":{"category":"mind_free","title":"Pinpoint数据分析思维导图","created":"2018-04-24 11:10:17","creator":"5ade96c6e4b0518eaccd0a8c","modified":"2018-04-26 21:21:12"},"type":"ProcessOn Schema File","version":"1.0"}}